{% extends "base.html" %}
{% block content %}
<style>
    .results-header {
        padding: 12px 10px;
        font-size: 16px;
        color: #eee;
        border-bottom: 1px solid #333;
        margin-bottom: 10px;
    }
    .video-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
        padding: 0 10px 20px;
    }
    .video-card {
        background: #1e1e1e;
        border-radius: 8px;
        overflow: hidden;
        cursor: pointer;
    }
    .video-card img {
        width: 100%;
        aspect-ratio: 16/9;
        object-fit: cover;
        background: #000;
    }
    .video-card .info {
        padding: 10px;
    }
    .video-card .title {
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 5px;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        line-height: 1.3;
        height: 2.6em;
    }
    .video-card .uploader {
        font-size: 12px;
        color: #aaa;
    }
    @media (max-width: 600px) {
        .video-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; }
    }
</style>

<div class="results-header">
    搜尋：<strong>{{ query }}</strong>
    {% if videos|length == 0 %}
    <span style="color:#888; font-size:13px;">（無結果）</span>
    {% endif %}
    <a href="/" style="float:right; color:#3ea6ff; font-size:13px;">回首頁</a>
</div>

<div class="video-grid">
    {% for video in videos %}
    <div class="video-card" onclick="openPlayer({ id: '{{ video.id }}', title: `{{ video.title|e }}`, uploader: `{{ video.uploader|e }}`, thumbnail: '{{ video.thumbnail }}', channel_id: '{{ video.channel_id }}' })">
        <img src="{{ video.thumbnail }}" loading="lazy">
        <div class="info">
            <div class="title">{{ video.title }}</div>
            <div class="uploader">{{ video.uploader }}</div>
        </div>
    </div>
    {% endfor %}
</div>
<script>
    console.log("[results] logged_in:", {{ 'true' if logged_in else 'false' }});
    console.log("[results] videos:", {{ videos|length }});
    if (typeof openPlayer !== 'function') {
        console.warn('[results] openPlayer not available on this page.');
    }
</script>
{% endblock %}
